(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{3166:function(t,e,n){Promise.resolve().then(n.bind(n,7123))},7123:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var o=n(7437),r=n(2265),a=n(9376),c=n(4362),i=n(4555);function l(t){let{children:e}=t,n=(0,a.useRouter)(),{isAuthenticated:l,isLoading:u}=(0,c.a)();return((0,r.useEffect)(()=>{u||l||n.replace("/login")},[l,u,n]),u)?(0,o.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:(0,o.jsx)(i.c,{size:"lg",color:"secondary"})}):l?(0,o.jsx)(o.Fragment,{children:e}):null}},4362:function(t,e,n){"use strict";n.d(e,{H:function(){return i},a:function(){return l}});var o=n(7437),r=n(2265),a=n(1837);let c=(0,r.createContext)(void 0);function i(t){let{children:e}=t,[n,i]=(0,r.useState)(null),[l,u]=(0,r.useState)(null),[s,f]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let t=localStorage.getItem("token");t?(u(t),a.iJ.getCurrentUser(t).then(t=>{i(t)}).catch(()=>{localStorage.removeItem("token"),u(null)}).finally(()=>{f(!1)})):f(!1)},[]);let d=async t=>{let e=await a.iJ.login(t);u(e.access_token),i(e.user),localStorage.setItem("token",e.access_token)};return(0,o.jsx)(c.Provider,{value:{user:n,token:l,isAuthenticated:!!l&&!!n,isLoading:s,login:d,logout:()=>{l&&a.iJ.logout(l).catch(console.error),u(null),i(null),localStorage.removeItem("token")}},children:e})}function l(){let t=(0,r.useContext)(c);if(!t)throw Error("useAuth must be used within AuthProvider");return t}},1837:function(t,e,n){"use strict";n.d(e,{BQ:function(){return r},Bl:function(){return l},Z9:function(){return i},iJ:function(){return c}});let o=()=>window.location.origin,r=()=>{{let t="https:"===window.location.protocol?"wss:":"ws:";return"".concat(t,"//").concat(window.location.host)}};async function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r={"Content-Type":"application/json",...e.headers};n&&(r.Authorization="Bearer ".concat(n));let a=await fetch("".concat(o()).concat(t),{...e,headers:r});if(!a.ok)throw Error((await a.json().catch(()=>({detail:"Unknown error"}))).detail||"HTTP ".concat(a.status));return a.json()}let c={login:t=>a("/api/auth/login",{method:"POST",body:JSON.stringify(t)}),getCurrentUser:t=>a("/api/auth/me",{},t),logout:t=>a("/api/auth/logout",{method:"POST"},t)},i={getStatus:t=>a("/api/crawler/status",{},t),start:(t,e)=>a("/api/crawler/start",{method:"POST",body:JSON.stringify(e)},t),stop:t=>a("/api/crawler/stop",{method:"POST"},t),getPlatforms:t=>a("/api/crawler/platforms",{},t)},l={getFiles:(t,e,n)=>{let o=new URLSearchParams;e&&o.append("platform",e),n&&o.append("file_type",n);let r=o.toString();return a("/api/data/files".concat(r?"?".concat(r):""),{},t)},getFileContent:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return a("/api/data/files/".concat(encodeURIComponent(e),"?preview=true&limit=").concat(n),{},t)},export:(t,e,n)=>fetch("".concat(o(),"/api/data/").concat(e,"/export?format=").concat(n),{headers:{Authorization:"Bearer ".concat(t)}}).then(t=>t.blob()),delete:(t,e,n)=>a("/api/data/".concat(e,"/").concat(n),{method:"DELETE"},t)}}},function(t){t.O(0,[69,971,117,744],function(){return t(t.s=3166)}),_N_E=t.O()}]);